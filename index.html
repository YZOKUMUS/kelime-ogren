<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Kelime Oyunu</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #034fc2, #0f62e7);

            
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 101vh;
            overflow: hidden;
        }

        #app {
            background-color:#241111;    /* kahverengi alanın rengini buradan değiştir */
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            display: flex;
            gap: 10px;
            width: 100%;
            max-width: 1200px;
            height: 91%;
        }

        .sidebar {
            flex: 0 0 170px;
            background-color: #f1f1f1;
            border-radius: 10px;
            padding: 10px;
            overflow-y: auto;
            max-height: 300px;
        }

        .sidebar h3 {
            margin-bottom: 10px;
        }

        .sidebar ul {
            list-style: none;
            padding: 0;
        }

        .sidebar button {
            width: 100%;
            font-size: 16px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .sidebar button.active {
            background-color: #27ae60;
        }

        .sidebar button:hover {    
            background-color: #2980b9;    
        }

        .main-content {
            flex: 1;    
            display: flex;    
            flex-direction: column;    
            align-items: center;
            justify-content: center;
        }

        .arabic {
            position: relative;  /* Bu satır eklendi */
            font-family: 'Amiri', serif;
            font-size: 10vw;
            font-weight: lighter;
            color: #F5D300;    /* arapça kelimenin rengini buradan değiştirebilir */
            border: 2px solid #4CAF50;  /*Kartın etrafına 2 piksel genişliğinde ve yeşil (#4CAF50) renkte bir sınır ekler. Bu, kartı görsel olarak tanımlayıcı hale getirir.*/
            border-radius: 15px;
            text-align: center;   /*Arapça kelime) yatayda ortalanır. Yani, Arapça kelime kartının ortasında yer alır.*/
            width: 100%;       /*Arapça kelime kartının genişliğini %100 olarak ayarlar. Bu, kartın içeriğine göre genişleyip daralmasını sağlar.*/
            height: 100%;      /*Arapça kelime kartının yüksekliğini %100 olarak ayarlar. Bu, kartın içeriğine göre yükselebileceği anlamına gelir.*/
            margin: 10px;      /*Arapça kelime kartının kenar boşluklarını 10 piksel olarak ayarlar. Bu, kartın içeriğinden dış kenarlarına kadar olan mesafeyi belirler.*/
            padding: 10px;     /*Arapça kelime kartının içerisindeki metnin etrafına 10 piksel boşluk bırakır. Bu, metnin kartın kenarlarına olan mesafesini belirler.*/
            display: flex;     /*Arapça kelime kartını yatayda hizalar. Yani, Arapça kelime kartı içerisindeki metni yatayda ortalar.*/
            justify-content: center;   /*Arapça kelime kartını yatayda ortalar. Yani, Arapça kelime kartı içerisindeki metni yatayda ortalar.*/
            align-items: center;       /*Arapça kelime kartını dikeyde ortalar. Yani, Arapça kelime kartı içerisindeki metni dikeyde ortalar.*/
            word-wrap: break-word;          /*Arapça kelime kartının içerisindeki metni, kelime uzunluğuna göre otomatik olarak satır sonuna alır. Bu, kelimenin kartın sınırlarını aşmasını engeller.*/
        }

        .correct-count {                /* Bu satır eklendi */
            position: absolute;    /* Elemanın konumunun, en yakın konumlandırılmış (relative, absolute, fixed) üst öğeye göre belirlenmesini sağlar. Bu durumda, doğru cevap sayacı "absolute" konumlandırıldığından, etrafındaki öğelere göre esnek bir şekilde konumlanabilir.Bu satır eklendi */
            bottom: 10px;        /* Sayacın alt kısmından 10 piksel mesafe bırakır. */
            right: 10px;            /* Sayacın sağ kısmından 10 piksel mesafe bırakır */
            background-color: rgba(235, 212, 212, 0.6);   /* Sayacın arka plan rengini siyah ve %60 saydamlıkta ayarlar */
            color: #fff;                /* Sayacın yazı rengini beyaz yapar. */
            font-size: 14px;         /* Sayacın yazı font boyutunu 14 piksel olarak ayarlar */
            padding: 5px 10px;     /* Sayacın içerisindeki metnin etrafına 5 piksel üst ve alt, 10 piksel sağ ve sol boşluk bırakır */
            border-radius: 5px;         /* Sayacın kenarlarını yuvarlar */
            font-weight: bold;     /* Sayacın yazı fontunu kalın yapar */
        }

        .options {
            display: flex;              /*Seçenek butonlarını yatayda hizalar */
            flex-wrap: wrap;                    /*Seçenek butonlarının sığmadığı durumda bir alt satıra geçmesini sağlar */
            gap: 10px;                  /*Seçenek butonları arasına 10 piksel boşluk bırakır */
            justify-content: center;            /*Seçenek butonlarını yatayda ortalar */
            padding: 10px;            /*Seçenek butonlarının etrafına 10 piksel boşluk bırakır */
            margin: 10px;           /*Seçenek butonlarının dış kenarlarına 10 piksel boşluk bırakır */
        }

        .options button {
            font-size: 16px;                      /*Buton metin font boyutunu 16 piksel olarak ayarlar */
            width: 100px;                     /*Buton genişliğini 100 piksel olarak ayarlar */
            height: 40px;                    /*Buton yüksekliğini 40 piksel olarak ayarlar */
            background-color: #3498db;      /*Butonun arka plan rengini mavi */
            color: white;                    /*Butonun metin rengini beyaz */
            border: solid;                  /*Butonun kenarlığını kaldırır */
            border-radius: 5px;              /*Butonun kenarlarını yuvarlar */
            cursor: pointer;                 /*Fare imlecinin butonun üzerine geldiğinde el şeklini almasını sağlar */
            transition: background-color 0.3s ease;      /*Butonun üzerine gelindiğinde arka plan renginin değişmesini sağlar */
        }

        .options button:hover {
            background-color: #b9293d; /*Darken the background color when the button is hovered */
        }

        @media screen and (max-width: 768px) {
            #app {
                flex-direction: column;  /*Küçük ekranlarda, uygulama düşey olarak hizalanır */
                height: auto;  /*Küçük ekranlarda, uygulama yüksekliği otomatik olarak ayarlanır */
                padding: 10px;  /*Küçük ekranlarda, uygulama kenar boşlukları 10 piksel olarak ayarlanır */
            }

            .arabic {
                font-size: 80px; /*Küçük ekranlarda, Arapça kelime font boyutu 80 piksel olarak ayarlanır */
                width: 95vw;        /*Küçük ekranlarda, Arapça kelime kartının genişliği 95 viewport genişliği olarak ayarlanır */
                margin: 10px;     /*Küçük ekranlarda, Arapça kelime kartının kenar boşlukları 10 piksel olarak ayarlanır */
            }

            .options button {
                width: 100%;        /*Küçük ekranlarda, seçenek butonlarının genişliği yüzde 100 olarak ayarlanır */
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="sidebar">
            <ul>
                <li v-for="sure in sureler" :key="sure">
                    <button @click="selectSure(sure)" :class="{ active: sure === selectedSure }">{{ sure }}</button>
                </li>
            </ul>
        </div>

        <div class="main-content">
            <div v-if="isTestStarted">
                <div class="arabic">
                    {{ currentWord.arabic }}
                    <div class="correct-count">Doğru: {{ correctCount }}</div>
                </div>
                <div class="options">
                    <button v-for="option in currentOptions" :key="option" @click="checkAnswer(option)">{{ option }}</button>
                </div>
                <audio v-if="currentWord.soundUrl" :src="currentWord.soundUrl" autoplay></audio>
            </div>

            <div v-if="!isTestStarted && testCompleted">
                <div class="score">
                    <p>Doğru: {{ correctCount }} / Yanlış: {{ incorrectCount }}</p>
                    <p>Toplam Puan: {{ score }}</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        new Vue({
    el: '#app',
    data: {
        isTestStarted: false,
        wordCards: [],
        currentCardIndex: 0,
        currentOptions: [],
        correctAnswer: '',
        correctCount: 0,  // Global doğru sayısı
        incorrectCount: 0,  // Global yanlış sayısı
        sureler: [],
        selectedSure: '',
        allWords: [],
        testCompleted: false,
        score: 0
    },
    computed: {
        currentWord() {
            return this.wordCards && this.wordCards.length > 0
                ? this.wordCards[this.currentCardIndex]
                : {};
        }
    },
    mounted() {
        this.loadJson();
        this.loadGameState();
    },
    methods: {
        loadJson() {
            const jsonUrl = 'https://raw.githubusercontent.com/YZOKUMUS/kelime-ogren/refs/heads/main/output.json';
            fetch(jsonUrl)
                .then(response => response.json())
                .then(data => {
                    const surelerSet = new Set(data.map(row => row.sure_adi));
                    this.sureler = Array.from(surelerSet);

                    this.allWords = data.map(row => ({
                        arabic: row['arabic_word'] || 'Bilinmiyor',
                        turkish: row['turkish_meaning'] || 'Bilinmiyor',
                        soundUrl: row['sound_url'] || '',
                        sureAdi: row['sure_adi'] || 'Bilinmiyor'
                    }));
                })
                .catch(err => {
                    console.error('Hata:', err);
                    alert('Kelime listesi yüklenirken bir hata oluştu.');
                });
        },

        selectSure(sure) {
            this.selectedSure = sure;
            this.wordCards = this.allWords.filter(word => word.sureAdi === sure);

            if (this.wordCards.length > 0) {
                this.shuffleArray(this.wordCards);
                this.isTestStarted = true;
                this.showOptions();
            } else {
                alert('Bu surede kelime bulunamadı.');
            }

            // currentCardIndex sıfırlanır, fakat doğru ve yanlış cevaplar devam eder.
            this.currentCardIndex = 0;
            this.testCompleted = false;
        },
        showOptions() {
            const correctOption = this.currentWord.turkish;
            const otherOptions = this.allWords
                .filter(word => word.turkish !== correctOption)
                .map(card => card.turkish);

            const randomIncorrectOptions = this.shuffleArray(otherOptions).slice(0, 3);
            this.currentOptions = this.shuffleArray([correctOption, ...randomIncorrectOptions]);
            this.correctAnswer = correctOption;
        },

        checkAnswer(option) {
            if (option === this.correctAnswer) {
                this.correctCount++;
                this.score++;
            } else {
                this.incorrectCount++;
                alert(`Yanlış cevap! Doğru cevap: ${this.correctAnswer}`);
            }
            this.saveGameState();
            this.nextWord();
        },

        nextWord() {
            if (this.currentCardIndex < this.wordCards.length - 1) {
                this.currentCardIndex++;
                this.showOptions();
            } else {
                this.testCompleted = true;
                this.isTestStarted = false;
                alert('Test tamamlandı!');
            }
        },

        shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        },

        loadGameState() {
            const savedState = localStorage.getItem('gameState');
            if (savedState) {
                const gameState = JSON.parse(savedState);
                this.score = gameState.score || 0;
                this.correctCount = gameState.correctCount || 0;
                this.incorrectCount = gameState.incorrectCount || 0;
            }
        },

        saveGameState() {
            const gameState = {
                score: this.score,
                correctCount: this.correctCount,
                incorrectCount: this.incorrectCount
            };
            localStorage.setItem('gameState', JSON.stringify(gameState));
        }
    }
});
    </script>
</body>
</html>
